{% extends 'base/base.html' %}
{% load static %}
{% load problemset_extras %}

{% block title %}{{ problem.title }}{% endblock %}

{% block content %}

<link rel="stylesheet" href="{% static 'problemset/css/problem.css' %}">

<section class="py-5 head">
    <div class="problem-container" dir="ltr">
        <div class="tab-container" dir="rtl">
            <div class="tab">
                <i class="bi bi-bookmark" style="cursor: pointer;"></i>
                <button class="tablinks" onclick="openSection(event, 'problem')" id="defaultOpen" style="margin-right: 25px;">سوال</button>
                <button class="tablinks" onclick="openSection(event, 'submissions')">ارسال ها</button>
              </div>

              <!-- Tab content -->
              <div id="problem" class="tabcontent">
                <h2>{{ problem.title }}<i class="bi bi-printer" style="float: left; cursor: pointer;"></i></h2>
                <ul>
                    <li>محدودیت زمان: {{ problem.time_limit }} ثانیه</li>
                    <li>محدودیت حافظه: {{ problem.memory_limit }} مگابایت</li>
                </ul>
                <hr>
                <p>{{ problem.detail }}</p>
                <hr>
                <h6>ارسال پاسخ برای این سوال</h6><br>
                <select>
                    {%  for language in problem.languages.all %}
                        <option>{{ language }}</option>
                    {% endfor %}
                </select>
                <br style='content: "";margin: 2em;display: block;font-size: 20%;'>
                <div class="file-section">
                    <label>
                        <i class="bi bi-paperclip" id="filename-label"> فایلی انتخاب نشده است</i>
                    </label>
                    <label class="choose-file" for="choosefile" style="width: 25%; text-align: center">انتخاب فایل</label>
                    <input id="choosefile" type="file" style="display: none">
                </div>
                <br>
                <button class="submit" id="submit">ارسال پاسخ</button>
              </div>

              <div id="submissions" class="tabcontent">
                <table dir="rtl">
                    <thead>
                        <tr>
                            <th>زمان ارسال</th>
                            <th>نوع فایل</th>
                            <th>وضعیت</th>
                            <th></th>
                        </tr>
                    </thead>

                    <tbody>
                        <tr>
                            <td>17 مرداد 1401، 15:13</td>
                            <td>Python</td>
                            <td><button class="score">100</button></td>
                            <td>
                                <button class="action-buttons"><i class="bi bi-download"></i></button>
                                <button class="action-buttons"><i class="bi bi-code-slash"></i></button>
                                <button class="action-buttons"><i class="bi bi-file-earmark-bar-graph-fill"></i></button>
                            </td>
                        </tr>
                    </tbody>
                </table>
              </div>
        </div>

        <div class="detail-section" id="detailSection" dir="rtl">
            <div class="detail">
                <div class="problem-status">
                    {% if problem.users.all|is_solved:user %}
                        <span class="tooltiptext">حل کامل</span>
                        <img class="problem-status-img" src="{%  static 'problemset/icons/solved.png' %}" alt="solved">
                    {% elif problem.users.all|is_partial:user %}
                        <span class="tooltiptext">حل ناتمام</span>
                        <img class="problem-status-img" src="{%  static 'problemset/icons/partial.png' %}" alt="partial">
                    {% else %}
                        <span class="tooltiptext">بدون تلاش</span>
                        <img class="problem-status-img" src="{%  static 'problemset/icons/no-try.png' %}" alt="no try">
                    {% endif %}
                </div>

                <label class="title">{{ problem.title }}</label><br>
                <a href="#" class="contest">{{ problem.contest.name }}</a>

                {% if problem.level == "easy" %}
                    <label class="level easy">ساده</label><br><br>
                {% elif problem.level == "intermediate" %}
                    <label class="level intermediate">متوسط</label><br><br>
                {% else %}
                    <label class="level hard">سخت</label><br><br>
                {% endif %}

                <div>
                    <button class="reaction">24 <img class="reaction-img" src="{%  static 'problemset/icons/thumbs-up.png' %}"></button>
                    <button class="reaction">24 <img class="reaction-img" src="{%  static 'problemset/icons/thumbs-down.png' %}"></button>
                    <button class="reaction">24 <img class="reaction-img" src="{%  static 'problemset/icons/thinking-face.png' %}"></button>
                    <button class="reaction">24 <img class="reaction-img" src="{%  static 'problemset/icons/cake.png' %}"></button>
                    <button class="reaction">24 <img class="reaction-img" src="{%  static 'problemset/icons/cry-face.png' %}"></button>
                </div><br>
                <label style="color: #696969;">برچسب ها</label>
                <br style='content: "";margin: 2em;display: block;font-size: 14%;'>
                {%  for tag in problem.tags.all %}
                    <label class="tags">{{ tag }}</label>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<script>
    document.getElementById("defaultOpen").click();

    function openSection(evt, cityName) {
    // Declare all variables
    var i, tabcontent, tablinks;

    // Get all elements with class="tabcontent" and hide them
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }

    // Get all elements with class="tablinks" and remove the class "active"
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }

    // Show the current tab, and add an "active" class to the button that opened the tab
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
    }

    document.querySelector("#choosefile").onchange = function(){
      let filename = document.querySelector("#choosefile").textContent = this.files[0].name;
      document.getElementById('filename-label').innerHTML = filename;

      let submit = document.getElementById('submit');
      submit.style.opacity = '100%';
      submit.style.cursor = 'pointer';
      submit.onmouseover = function()
        {
            this.style.backgroundColor = "#ee4ae2";
        }
      submit.onmouseleave = function()
        {
            this.style.backgroundColor = "#ee13df";
        }
    }
</script>

{% endblock content %}